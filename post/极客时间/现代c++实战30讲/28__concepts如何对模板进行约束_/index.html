<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>28__Conceptsï¼šå¦‚ä½•å¯¹æ¨¡æ¿è¿›è¡Œçº¦æŸ_ - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚
ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥äº†æœªæ¥ç¯‡ï¼Œå±•æœ›ä¸€ä¸‹å³å°†åœ¨ C&#43;&#43;20 å‡ºç°çš„æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¦è®¨è®ºçš„ï¼Œæ˜¯ conceptsï¼ˆæ¦‚å¿µï¼‰â€”â€”ä¸€ä¸ªéš¾äº§äº†å¾ˆå¤šå¹´æ‰ç»ˆäºè¿›å…¥ C&#43;&#43; çš„æ–°åŠŸèƒ½ã€‚
" /><meta name="keywords" content="æŠ€æœ¯æ–‡æ¡£, docs, æå®¢æ—¶é—´" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E7%8E%B0%E4%BB%A3c&#43;&#43;%E5%AE%9E%E6%88%9830%E8%AE%B2/28__concepts%E5%A6%82%E4%BD%95%E5%AF%B9%E6%A8%A1%E6%9D%BF%E8%BF%9B%E8%A1%8C%E7%BA%A6%E6%9D%9F_/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E7%8E%B0%E4%BB%A3c&#43;&#43;%E5%AE%9E%E6%88%9830%E8%AE%B2/28__concepts%E5%A6%82%E4%BD%95%E5%AF%B9%E6%A8%A1%E6%9D%BF%E8%BF%9B%E8%A1%8C%E7%BA%A6%E6%9D%9F_/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="28__Conceptsï¼šå¦‚ä½•å¯¹æ¨¡æ¿è¿›è¡Œçº¦æŸ_">
  <meta property="og:description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚
ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥äº†æœªæ¥ç¯‡ï¼Œå±•æœ›ä¸€ä¸‹å³å°†åœ¨ C&#43;&#43;20 å‡ºç°çš„æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¦è®¨è®ºçš„ï¼Œæ˜¯ conceptsï¼ˆæ¦‚å¿µï¼‰â€”â€”ä¸€ä¸ªéš¾äº§äº†å¾ˆå¤šå¹´æ‰ç»ˆäºè¿›å…¥ C&#43;&#43; çš„æ–°åŠŸèƒ½ã€‚">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="ç°ä»£C&#43;&#43;å®æˆ˜30è®²">

  <meta itemprop="name" content="28__Conceptsï¼šå¦‚ä½•å¯¹æ¨¡æ¿è¿›è¡Œçº¦æŸ_">
  <meta itemprop="description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚
ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥äº†æœªæ¥ç¯‡ï¼Œå±•æœ›ä¸€ä¸‹å³å°†åœ¨ C&#43;&#43;20 å‡ºç°çš„æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¦è®¨è®ºçš„ï¼Œæ˜¯ conceptsï¼ˆæ¦‚å¿µï¼‰â€”â€”ä¸€ä¸ªéš¾äº§äº†å¾ˆå¤šå¹´æ‰ç»ˆäºè¿›å…¥ C&#43;&#43; çš„æ–°åŠŸèƒ½ã€‚">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="4965">
  <meta itemprop="keywords" content="ç°ä»£C&#43;&#43;å®æˆ˜30è®²">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="28__Conceptsï¼šå¦‚ä½•å¯¹æ¨¡æ¿è¿›è¡Œçº¦æŸ_">
  <meta name="twitter:description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚
ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥äº†æœªæ¥ç¯‡ï¼Œå±•æœ›ä¸€ä¸‹å³å°†åœ¨ C&#43;&#43;20 å‡ºç°çš„æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¦è®¨è®ºçš„ï¼Œæ˜¯ conceptsï¼ˆæ¦‚å¿µï¼‰â€”â€”ä¸€ä¸ªéš¾äº§äº†å¾ˆå¤šå¹´æ‰ç»ˆäºè¿›å…¥ C&#43;&#43; çš„æ–°åŠŸèƒ½ã€‚">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">28__Conceptsï¼šå¦‚ä½•å¯¹æ¨¡æ¿è¿›è¡Œçº¦æŸ_</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> æå®¢æ—¶é—´ </a>
            </div>
          <span class="more-meta"> çº¦ 4965 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 10 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ä¸€ä¸ªå°ä¾‹å­">ä¸€ä¸ªå°ä¾‹å­</a></li>
        <li><a href="#concepts-ç®€å²">Concepts ç®€å²</a></li>
        <li><a href="#åŸºæœ¬çš„-concepts">åŸºæœ¬çš„ Concepts</a>
          <ul>
            <li><a href="#ç®€å•çš„æ¦‚å¿µæµ‹è¯•">ç®€å•çš„æ¦‚å¿µæµ‹è¯•</a></li>
          </ul>
        </li>
        <li><a href="#æ¦‚å¿µå‡ºé”™ä¿¡æ¯å’Œ-sfinae">æ¦‚å¿µã€å‡ºé”™ä¿¡æ¯å’Œ SFINAE</a></li>
        <li><a href="#å†…å®¹å°ç»“">å†…å®¹å°ç»“</a></li>
        <li><a href="#è¯¾åæ€è€ƒ">è¯¾åæ€è€ƒ</a></li>
        <li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚</p>
<p>ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥äº†æœªæ¥ç¯‡ï¼Œå±•æœ›ä¸€ä¸‹å³å°†åœ¨ C++20 å‡ºç°çš„æ–°åŠŸèƒ½ã€‚æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¦è®¨è®ºçš„ï¼Œæ˜¯ conceptsï¼ˆæ¦‚å¿µï¼‰â€”â€”ä¸€ä¸ªéš¾äº§äº†å¾ˆå¤šå¹´æ‰ç»ˆäºè¿›å…¥ C++ çš„æ–°åŠŸèƒ½ã€‚</p>
<h2 id="ä¸€ä¸ªå°ä¾‹å­">ä¸€ä¸ªå°ä¾‹å­</h2>
<p>è€è§„çŸ©ï¼Œè¦è®²â€œæ¦‚å¿µâ€ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¾‹å­ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ C++ é‡Œæœ‰é‡è½½ï¼Œå¯ä»¥æ ¹æ®å‚æ•°çš„ç±»å‹æ¥é€‰æ‹©åˆé€‚çš„å‡½æ•°ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ <code>half</code> å¯¹äº <code>int</code> å’Œ <code>string</code> æœ‰ä¸åŒçš„ä½œç”¨ï¼š</p>
<p>int half(int n)<br>
{<br>
return n / 2;<br>
}</p>
<p>string half(string s)<br>
{<br>
s.resize(s.size() / 2);<br>
return s;<br>
}</p>
<p>åˆçœ‹ï¼Œä¼¼ä¹é‡è½½å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†ç»†æƒ³ï¼Œä¸å¯¹å•Šï¼šé™¤äº† <code>int</code>ï¼Œæˆ‘ä»¬è¿˜æœ‰å·®ä¸å¤šçš„ <code>short</code>ã€<code>long</code> ç­‰ç±»å‹ï¼Œç”šè‡³è¿˜æœ‰ <code>boost::multiprecision::cpp_int</code>ï¼›é™¤äº† <code>string</code>ï¼Œæˆ‘ä»¬ä¹Ÿè¿˜æœ‰ <code>wstring</code>ã€<code>u16string</code>ã€<code>u32string</code> ç­‰ç­‰ã€‚ä¸Šé¢çš„æ¯ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šéƒ½é€‚ç”¨äºä¸€æ—ç±»å‹ï¼Œè€Œä¸æ˜¯å•ä¸ªç±»å‹ã€‚é‡è½½åœ¨è¿™æ–¹é¢å¹¶å¸®ä¸äº†ä»€ä¹ˆå¿™ã€‚</p>
<p>ä¹Ÿè®¸ä½ ç°åœ¨å·²ç»ååº”è¿‡æ¥äº†ï¼Œæˆ‘ä»¬æœ‰ SFINAE å•Šï¼å›ç­”éƒ¨åˆ†æ­£ç¡®ã€‚å¯æ˜¯ï¼Œä½ å‘Šè¯‰æˆ‘ä½ æœ‰æ²¡æœ‰æƒ³åˆ°ä¸€ç§å¾ˆç®€å•çš„æ–¹å¼èƒ½è®© SFINAE å¯¹æ•´æ•°ç±»å‹å¯ä»¥å·¥ä½œï¼ŸType traitsï¼Ÿå—¯å—¯ï¼Œæ€»æ˜¯å¯ä»¥è§£å†³çš„æ˜¯å§ï¼Œä½†è¿™ä¼šä¸ä¼šæ˜¯ä¸€æ¡æŠŠåˆå­¦è€…åŠé€€çš„é“è·¯å‘¢ï¼Ÿâ€¦â€¦</p>
<p>C++ çš„æ¦‚å¿µå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬åªéœ€è¦äº‹å…ˆå®šä¹‰äº† <code>Integer</code> å’Œ <code>String</code> çš„æ¦‚å¿µï¼ˆå¦‚ä½•å®šä¹‰ä¸€ä¸ªæ¦‚å¿µæˆ‘ä»¬åé¢ä¼šè¯´ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p>
<p>template <Integer N><br>
N half(N n)<br>
{<br>
return n / 2;<br>
}</p>
<p>template <String S><br>
S half(S s)<br>
{<br>
s.resize(s.size() / 2);<br>
return s;<br>
}</p>
<p>æˆ‘ä»¬åº”å½“äº†è§£ä¸€ä¸‹ï¼Œä»æ¦‚å¿µä¸Šè®²ï¼Œä¸Šé¢è¿™ç§å½¢å¼çš„å«ä¹‰å’Œä¸‹é¢çš„ä»£ç å®è´¨ç›¸åŒï¼ˆä»¥ä¸Šé¢çš„ç¬¬ä¸€ä¸ªå‡½æ•°ä¸ºä¾‹ï¼‰ï¼š</p>
<p>template <typename N><br>
requires Integer<N><br>
N half(N n)<br>
{<br>
return n / 2;<br>
}</p>
<p>å³ï¼Œè¿™ä¸ª <code>half</code> æ˜¯ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œæœ‰ä¸€ä¸ªæ¨¡æ¿å‚æ•°ï¼Œå¯ç”¨è¿™ä¸ªæ¨¡æ¿çš„å‰ææ¡ä»¶æ˜¯è¿™ä¸ªå‚æ•°æ»¡è¶³ <code>Integer</code> è¿™ä¸ªçº¦æŸã€‚</p>
<h2 id="concepts-ç®€å²">Concepts ç®€å²</h2>
<p>2019 å¹´ 11 æœˆï¼Œä¸Šæµ·ï¼Œå½“åœ¨ C++ å³°ä¼šä¸Šè¢«é—®èµ·ä»–æœ€å–œæ¬¢çš„ C++ ç‰¹æ€§æœ‰å“ªäº›æ—¶ï¼ŒBjarne çš„å›ç­”é‡Œå°±æœ‰ conceptsã€‚è¿™ä¸æ¯«ä¸è®©æˆ‘æ„Ÿåˆ°æƒŠè®¶ã€‚è™½ç„¶ C++ çš„â€œæ¦‚å¿µâ€çœ‹èµ·æ¥æ˜¯ä¸ªæŒºç®€å•çš„æ¦‚å¿µï¼Œä½†å®ƒçš„å†å²å¹¶ä¸çŸ­â€”â€”Bjarne æƒ³æŠŠå®ƒåŠ å…¥ C++ å·²ç»æœ‰å¥½å¤šå¹´äº† [1]ã€‚</p>
<p>ä»åŸºæœ¬æ¦‚å¿µä¸Šæ¥è®²ï¼Œâ€œæ¦‚å¿µâ€å°±æ˜¯ä¸€ç»„å¯¹æ¨¡æ¿å‚æ•°çš„çº¦æŸæ¡ä»¶ã€‚æˆ‘ä»¬è®¨è®ºè¿‡æ¨¡æ¿å°±æ˜¯ C++ é‡Œçš„é¸­å­ç±»å‹ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰æè¿‡ï¼ŒBjarne å¯¹æ¨¡æ¿çš„æ¥å£å®é™…ä¸Šæ˜¯ç›¸å½“ä¸æ»¡æ„çš„ï¼šä»–è‡ªå·±çš„ç”¨è¯ç›´æ¥å°±æ˜¯ lousyï¼Œå¹¶è®¤ä¸ºè¿™ä¸€ç³Ÿç³•çš„æ¥å£è®¾è®¡æ˜¯åé¢å¯¼è‡´äº†ææ€–çš„æ¨¡æ¿ç¼–è¯‘é”™è¯¯ä¿¡æ¯çš„æ ¹æºã€‚</p>
<p>ä»å¦ä¸€æ–¹é¢è®²ï¼ŒAlex Stepanov è®¾è®¡çš„ STL ä¸€å¼€å§‹å°±åŒ…å«äº†â€œæ¦‚å¿µâ€çš„æ¦‚å¿µï¼Œå¦‚æˆ‘ä»¬åœ¨ [ç¬¬ 7 è®²] ä¸­æåˆ°çš„å„ç§ä¸åŒç±»å‹çš„è¿­ä»£å™¨ï¼š</p>
<ol>
<li>Output Iterator</li>
<li>Input Iterator</li>
<li>Forward Iterator</li>
<li>Bidirectional Iterator</li>
<li>Random Access Iterator</li>
<li>â€¦</li>
</ol>
<p>è¿™äº›æ¦‚å¿µå‡ºç°åœ¨äº† STL çš„æ–‡æ¡£ä¸­ï¼Œæœ‰è¯¦ç»†çš„å®šä¹‰ï¼›ä½†å®ƒä»¬åªæ˜¯è½åœ¨çº¸é¢ä¸Šï¼Œè€Œæ²¡æœ‰åœ¨ C++ è¯­è¨€ä¸­æœ‰çœŸæ­£çš„ä½“ç°ã€‚åæ¥ï¼Œä»–è¿˜è¿›ä¸€æ­¥æŠŠå¾ˆå¤šæ¦‚å¿µçš„å½¢å¼æè¿°å†™è¿›äº†ä»–äº 2009 å¹´ï¼ˆå’Œ Paul McJones ä¸€èµ·ï¼‰å‡ºç‰ˆçš„â€œç¥ä½œâ€ Elements of Programming [2] ä¸­ï¼Œå¹¶ç»™å‡ºäº†å‡æƒ³çš„å®ç°ä»£ç â€”â€”å…¶ä¸­å°±æœ‰å…³é”®å­— <code>requires</code>â€”â€”å³ä½¿é‚£æ—¶æ²¡æœ‰ä»»ä½•ç¼–è¯‘å™¨èƒ½å¤Ÿç¼–è¯‘è¿™æ ·çš„ä»£ç ã€‚</p>
<p>åœ¨ C++ ç¬¬ä¸€æ¬¡æ ‡å‡†åŒ–ï¼ˆ1998ï¼‰ä¹‹åï¼ŒBjarne å¤šæ¬¡è¯•å›¾æŠŠâ€œæ¦‚å¿µâ€å¼•å…¥ C++ï¼ˆæ ¹æ®æˆ‘çœ‹åˆ°çš„æ–‡çŒ®ï¼Œä»–åœ¨ 03 åˆ° 09 å¹´ç›´æ¥æœ‰è‡³å°‘ä¹ç¯‡å•ç‹¬æˆ–åˆè‘—çš„è®ºæ–‡è·Ÿâ€œæ¦‚å¿µâ€æœ‰å…³ï¼‰ï¼Œä½†ä¸€ç›´æ²¡æœ‰æˆåŠŸâ€”â€”é­”é¬¼åœ¨ç»†èŠ‚ï¼Œä¸€æ—¦è¿›å…¥ç»†èŠ‚ï¼Œäººä»¬å¯¹ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆç¾çš„ç‚¹å­çš„åˆ†æ­§å°±éå¸¸å¤§äº†ã€‚ä¸€ç›´åˆ° C++11 æ ‡å‡†åŒ–ï¼Œâ€œæ¦‚å¿µâ€è¿˜æ˜¯å› ä¸ºè‰æ¡ˆå¤æ‚ã€äº‰è®®å¤šã€æ— æˆç†Ÿå®ç°è€Œæ²¡æœ‰è¿›å…¥ C++ æ ‡å‡†ã€‚</p>
<p>ç›®å‰ C++20 é‡Œçš„â€œæ¦‚å¿µâ€çš„åŸºç¡€æ˜¯ 2009 å¹´é‡æ–°å¯åŠ¨çš„ Concepts Liteï¼Œå¹¶åœ¨ 2015 å¹´å‡ºç‰ˆæˆä¸ºæŠ€æœ¯è§„æ ¼ä¹¦ Concepts TSï¼ˆæ­£å¼çš„ TS æ–‡æ¡£éœ€è¦èŠ±é’±è´­ä¹°ï¼Œæˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥äº†è§£å¯ä»¥æŸ¥çœ‹æ­£å¼å‡ºç‰ˆå‰çš„è‰æ¡ˆ [3]ï¼‰ã€‚å¾ˆå¤šäººå‚ä¸äº†ç›¸å…³å·¥ä½œï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº† Andrew Suttonã€Bjarne Stroustrup å’Œ Alex Stepanovã€‚è¿™å›ï¼Œå®ç°ç®€åŒ–äº†ï¼Œæœ‰äº†ä¸€ä¸ªå®ç°ï¼ˆGCCï¼‰ï¼Œäº‰è®®ä¹Ÿå°‘å¤šäº†ã€‚ç„¶è€Œï¼Œâ€œæ¦‚å¿µâ€è¿˜æ˜¯æ²¡æœ‰è¿›å…¥ C++17ï¼Œä¸»è¦ç”±äºä¸‹é¢è¿™äº›åŸå› ï¼š</p>
<ol>
<li>ä» Concepts TS å‡ºç‰ˆåˆ°æ ‡å‡†å®šç¨¿åªæœ‰ä¸åˆ°å››ä¸ªâ½‰çš„æ—¶é—´ï¼ˆC++20 çš„å†…å®¹ä¹ŸåŒæ ·æ˜¯åœ¨ 2019 å¹´å°±å…¨éƒ¨å†»ç»“äº†ï¼Œåˆ°æ­£å¼å‡ºç‰ˆå‰çš„æ—¶é—´ç•™ä¸ªä¿®æ­£å°é—®é¢˜å’Œèµ°æ‰¹å‡†æµç¨‹ï¼‰</li>
<li>â€œæ¦‚å¿µâ€åªæœ‰ä¸€ä¸ªå®ç°ï¼ˆGCCï¼‰</li>
<li>Concepts TS è§„æ ¼ä¹¦çš„ä½œè€…å’Œ GCC ä¸­çš„æ¦‚å¿µå®ç°è€…æ˜¯åŒâ¼€ä¸ªâ¼ˆï¼Œæ²¡æœ‰â¼ˆç‹¬â½´åœ°ä»è§„æ ¼ä¹¦å‡ºå‘å®ç°æ¦‚å¿µ</li>
<li>Concepts TS â¾¥æ²¡æœ‰å®é™…å®šä¹‰æ¦‚å¿µï¼Œæ ‡å‡†åº“ä¹Ÿæ²¡æœ‰æŠŠæ¦‚å¿µç”¨èµ·æ¥</li>
</ol>
<p>å½“ç„¶ï¼Œå¤§å®¶è¿˜æ˜¯è®¤å¯â€œæ¦‚å¿µâ€æ˜¯ä¸ªå¥½åŠŸèƒ½ï¼Œåˆ°äº† 2017 å¹´ 7 æœˆï¼Œâ€œæ¦‚å¿µâ€å°±æ­£å¼å¹¶å…¥ C++20 è‰æ¡ˆäº†ã€‚ä¹‹åï¼Œå°ä¿®è®¢è¿˜æ˜¯ä¸å°‘çš„ï¼ˆæ‰€ä»¥â€œæ¦‚å¿µâ€æ²¡æœ‰è¿›å…¥ C++20 ä¹Ÿä¸å®Œå…¨æ˜¯ä»¶åäº‹ï¼‰ã€‚ä»ç”¨æˆ·çš„è§’åº¦ï¼Œæœ€å¤§çš„ä¸€ä¸ªæ”¹å˜æ˜¯â€œæ¦‚å¿µâ€çš„åå­—ï¼šç›®å‰ï¼Œæ‰€æœ‰æ ‡å‡†â€œæ¦‚å¿µâ€ä»å…¨éƒ¨ç”±å¤§å†™å­—æ¯æ‰“å¤´æ”¹æˆäº†â€œæ ‡å‡†å¤§å°å†™â€â€”â€”å³å…¨éƒ¨å°å†™å­—æ¯åŠ ä¸‹åˆ’çº¿ [4]ã€‚æ¯”å¦‚ï¼Œå…è®¸ç›¸ç­‰æ¯”è¾ƒè¿™ä¸ªæ¦‚å¿µï¼ŒåŸå…ˆå†™ä½œ <code>EqualityComparable</code>ï¼Œç°åœ¨è¦å†™æˆ <code>equality_comparable</code>ã€‚</p>
<h2 id="åŸºæœ¬çš„-concepts">åŸºæœ¬çš„ Concepts</h2>
<p>ä¸‹å›¾ä¸­ç»™å‡ºäº† C++ é‡Œå¯¹è±¡ç›¸å…³çš„éƒ¨åˆ†æ ‡å‡†æ¦‚å¿µï¼ˆä¸å®Œæ•´ï¼‰ï¼š</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%8E%B0%E4%BB%A3C++%E5%AE%9E%E6%88%9830%E8%AE%B2/78612a1609ddc530ad2e416992c8bcdd.png" alt=""></p>
<p>æˆ‘ä»¬ä»ä¸‹å¾€ä¸Šå¿«é€Ÿçœ‹ä¸€ä¸‹ï¼š</p>
<ol>
<li><code>move_constructible</code>ï¼šå¯ç§»åŠ¨æ„é€ </li>
<li><code>swappable</code>ï¼šå¯äº¤æ¢</li>
<li><code>movable</code>ï¼šå¯ç§»åŠ¨æ„é€ ã€å¯äº¤æ¢ï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯å¯ç§»åŠ¨äº†</li>
<li><code>copy_constructible</code>ï¼šå¯æ‹·è´æ„é€ </li>
<li><code>copyable</code>ï¼šå¯æ‹·è´æ„é€ ã€å¯ç§»åŠ¨ï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯å¯å¤åˆ¶äº†ï¼ˆæ³¨ï¼šè¿™å„¿â€œæ‹·è´â€å’Œâ€œå¤åˆ¶â€åªæ˜¯æˆ‘åœ¨ç¿»è¯‘ä¸­åšçš„ä¸€ç‚¹å°åŒºåˆ†ï¼Œè‹±æ–‡ä¸­æ²¡æœ‰åŒºåˆ«ï¼‰</li>
<li><code>default_initializable</code>ï¼šå¯é»˜è®¤åˆå§‹åŒ–ï¼ˆåå­—ä¸å« <code>default_constructible</code> æ˜¯å› ä¸ºç›®å‰çš„ type traits ä¸­æœ‰ <code>is_default_constructible</code>ï¼Œä¸”æ„ä¹‰å’Œ <code>default_initializable</code> æœ‰ç‚¹å¾®å¦™çš„åŒºåˆ«ï¼›è¯¦è§é—®é¢˜æŠ¥å‘Š 3338ï¼‰</li>
<li><code>semiregular</code>ï¼šå¯å¤åˆ¶ã€å¯é»˜è®¤åˆå§‹åŒ–ï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯åŠæ­£åˆ™äº†</li>
<li><code>equality_comparable</code>ï¼šå¯ç›¸ç­‰æ¯”è¾ƒï¼Œå³å¯¹è±¡ä¹‹é—´å¯ä»¥ä½¿ç”¨ <code>==</code> è¿ç®—ç¬¦</li>
<li><code>regular</code>ï¼šåŠæ­£åˆ™ã€å¯ç›¸ç­‰æ¯”è¾ƒï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯æ­£åˆ™äº†</li>
</ol>
<p>è¿™äº›â€œæ¦‚å¿µâ€ç°åœ¨ä¸åªæ˜¯æ–‡å­—æè¿°ï¼Œç»å¤§éƒ¨åˆ†æ˜¯å¯ä»¥çœŸæ­£åœ¨ä»£ç ä¸­å®šä¹‰çš„ã€‚ç°åœ¨ï¼Œå‡†æ ‡å‡†çš„å®šä¹‰å·²ç»å¯ä»¥åœ¨ cppreference.com ä¸Šæ‰¾åˆ° [5]ã€‚ä»å®é™…çš„è§’åº¦ï¼Œä¸‹é¢æˆ‘ä»¬åˆ—ä¸¾éƒ¨åˆ†æ¦‚å¿µåœ¨ CMCSTL2 [6]â€”â€”ä¸€ä¸ª Rangesï¼ˆæˆ‘ä»¬ä¸‹ä¸€è®²è®¨è®ºï¼‰çš„å‚è€ƒå®ç°â€”â€”ä¸­çš„å®šä¹‰ã€‚</p>
<p>ä»ç®€å•æ€§çš„è§’åº¦ï¼Œæˆ‘ä»¬è‡ªä¸Šå¾€ä¸‹çœ‹ï¼Œé¦–å…ˆæ˜¯ <code>regular</code>ï¼š</p>
<p>template <class T><br>
concept regular =<br>
semiregular<T> &amp;&amp;<br>
equality_comparable<T>;</p>
<p>å¾ˆç®€å•å§ï¼Œå®šä¹‰ä¸€ä¸ª concept æ­¤å¤„åªæ˜¯ä¸€äº›é’ˆå¯¹ç±»å‹çš„æ¡ä»¶è€Œå·²ã€‚å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªæ¦‚å¿µæµ‹è¯•è¡¨è¾¾å¼ï¼ˆå¦‚ <code>semiregular&lt;T&gt;</code>ï¼‰çš„ç»“æœæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆç¼–è¯‘æœŸå¸¸é‡ï¼‰ã€‚</p>
<p>ç„¶åæ˜¯ <code>semiregular</code>ï¼š</p>
<p>template <class T><br>
concept semiregular =<br>
copyable<T> &amp;&amp;<br>
default_initializable<T>;</p>
<p>å†çœ‹ä¸€çœ¼ <code>equality_comparable</code>ï¼š</p>
<p>template &lt;class T, class U&gt;<br>
concept WeaklyEqualityComparable =<br>
requires(<br>
const remove_reference_t<T>&amp; t,<br>
const remove_reference_t<U>&amp; u) {<br>
{ t == u } -&gt; boolean;<br>
{ t != u } -&gt; boolean;<br>
{ u == t } -&gt; boolean;<br>
{ u != t } -&gt; boolean;<br>
};</p>
<p>template <class T><br>
concept equality_comparable =<br>
WeaklyEqualityComparable&lt;T, T&gt;;</p>
<p>è¿™ä¸ªç¨å¤æ‚ç‚¹ï¼Œç”¨åˆ°äº† <code>requires</code> [7]ï¼Œä½†ä¸éœ€è¦æˆ‘è®²è§£ï¼Œä½ ä¹Ÿèƒ½çœ‹å‡ºæ¥ <code>equality_comparable</code> çš„è¦æ±‚å°±æ˜¯ç±»å‹çš„å¸¸å·¦å€¼å¼•ç”¨ä¹‹é—´å…è®¸è¿›è¡Œ <code>==</code> å’Œ <code>!=</code> çš„æ¯”è¾ƒï¼Œä¸”è¿”å›ç±»å‹ä¸ºå¸ƒå°”ç±»å‹å§ã€‚</p>
<p>æ³¨æ„ä¸Šé¢çš„å®šä¹‰é‡Œå†™çš„æ˜¯ <code>boolean</code> è€Œä¸æ˜¯ <code>bool</code>ã€‚è¿™ä¸ªæ¦‚å¿µå®šä¹‰ä¸è¦æ±‚æ¯”è¾ƒè¿ç®—ç¬¦çš„ç»“æœç±»å‹æ˜¯ <code>bool</code>ï¼Œè€Œæ˜¯å¯ä»¥ç”¨åœ¨éœ€è¦å¸ƒå°”å€¼çš„ä¸Šä¸‹æ–‡ä¸­ã€‚è‡ªç„¶ï¼Œ<code>boolean</code> ä¹Ÿæ˜¯æœ‰å®šä¹‰çš„ï¼Œä½†è¿™ä¸ªå®šä¹‰å¯èƒ½æ¯”ä½ æƒ³è±¡çš„å¤æ‚ï¼Œæˆ‘è¿™å„¿å°±ä¸å†™å‡ºæ¥äº†ğŸ˜œã€‚</p>
<p>æˆ‘ä»¬ä¹‹å‰å·²ç»è®²è¿‡äº†å„ç§è¿­ä»£å™¨ï¼Œæ¯ä¸ªè¿­ä»£å™¨ä¹Ÿè‡ªç„¶åœ°æ»¡è¶³ä¸€ä¸ªâ€œæ¦‚å¿µâ€â€”â€”æ¦‚å¿µåç§°åŸºæœ¬ä¸Šå°±æ˜¯ä¹‹å‰ç»™çš„ï¼Œåªæ˜¯å¤§å°å†™è¦å˜åŒ–ä¸€ä¸‹è€Œå·²ã€‚æœ€åº•ä¸‹çš„ <code>iterator</code> æ˜¯ä¸ªä¾‹å¤–ï¼šå› ä¸ºè¿™ä¸ªåå­—åœ¨æ ‡å‡†é‡Œå·²ç»è¢«å ç”¨å•¦ã€‚æ‰€ä»¥ç°åœ¨å®ƒçš„åå­—æ˜¯ <code>input_or_output_iterator</code>ã€‚</p>
<p>è¿­ä»£å™¨æœ¬èº«éœ€è¦æ»¡è¶³å“ªäº›æ¦‚å¿µå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%8E%B0%E4%BB%A3C++%E5%AE%9E%E6%88%9830%E8%AE%B2/e17ea32686775843f83a0aa6ae07505f.png" alt=""></p>
<p>æ³¨æ„è¿™å¼ è·Ÿä¸Šé¢é‚£å¼ å›¾ä¸ä¸€æ ·ï¼Œæ¦‚å¿µä¹‹é—´ä¸æ˜¯ç®€å•çš„â€œåˆå–â€å…³ç³»ï¼Œè€Œæ˜¯ä¸€ç§â€œç»§æ‰¿â€å…³ç³»ï¼šä¸Šé¢çš„æ¦‚å¿µæ¯”å®ƒæŒ‡å‘çš„ä¸‹é¢çš„æ¦‚å¿µæœ‰æ›´å¤šçš„è¦æ±‚ã€‚å…·ä½“åˆ°ä»£ç ï¼š</p>
<p>template <class I><br>
concept weakly_incrementable =<br>
semiregular<I> &amp;&amp; requires(I i) {<br>
typename iter_difference_t<I>;<br>
requires signed_integral&lt;<br>
iter_difference_t<I>&gt;;<br>
{ ++i } -&gt; same_as&lt;I&amp;&gt;;<br>
i++;<br>
};</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>weakly_incrementable</code> æ˜¯ <code>semiregular</code> å†åŠ ä¸€äº›é¢å¤–çš„è¦æ±‚ï¼š</p>
<ol>
<li><code>iter_difference_t&lt;I&gt;</code> æ˜¯ä¸€ä¸ªç±»å‹</li>
<li><code>iter_difference_t&lt;I&gt;</code> æ˜¯ä¸€ä¸ªæœ‰ç¬¦å·çš„æ•´æ•°ç±»å‹</li>
<li><code>++i</code> çš„ç»“æœè·Ÿ <code>I&amp;</code> æ˜¯å®Œå…¨ç›¸åŒçš„ç±»å‹</li>
<li>èƒ½å¤Ÿæ‰§è¡Œ <code>i++</code> æ“ä½œï¼ˆä¸æ£€æŸ¥ç»“æœçš„ç±»å‹ï¼‰</li>
</ol>
<p><code>input_or_output_iterator</code> ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>template <class I><br>
concept input_or_output_iterator =<br>
__dereferenceable&lt;I&amp;&gt; &amp;&amp;<br>
weakly_incrementable<I>;</p>
<p>å°±æ˜¯è¦æ±‚å¯ä»¥è§£å¼•ç”¨ã€å¯ä»¥æ‰§è¡Œ <code>++</code>ã€å¯ä»¥ä½¿ç”¨ <code>iter_difference_t</code> æå–è¿­ä»£å™¨çš„ <code>difference_type</code> è€Œå·²ã€‚</p>
<p>å‰©ä¸‹çš„æ¦‚å¿µçš„å®šä¹‰ä¹Ÿä¸å¤æ‚ï¼Œæˆ‘è¿™å„¿å°±ä¸ä¸€ä¸€è®²è§£äº†ã€‚æ„Ÿå…´è¶£çš„è¯ä½ å¯ä»¥è‡ªå·±å»çœ‹ CMCSTL2 çš„æºä»£ç ã€‚</p>
<h3 id="ç®€å•çš„æ¦‚å¿µæµ‹è¯•">ç®€å•çš„æ¦‚å¿µæµ‹è¯•</h3>
<p>ä¸ºäº†è®©ä½ å†ç®€å•æ„Ÿå—ä¸€ä¸‹æ ‡å‡†çš„æ¦‚å¿µï¼Œæˆ‘å†™äº†ä¸‹é¢è¿™ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºï¼Œå±•ç¤ºä¸€äº›æ ‡å‡†æ¦‚å¿µçš„æµ‹è¯•ç»“æœï¼š</p>
<p>#include <armadillo><br>
#include <iostream><br>
#include <memory><br>
#include <string><br>
#include &lt;type_traits&gt;</p>
<p>using namespace std;</p>
<p>#if defined(__cpp_concepts)</p>
<p>#if __cpp_concepts &lt; 201811</p>
<p>#include &lt;experimental/ranges/concepts&gt;<br>
using namespace experimental::ranges;</p>
<p>#else</p>
<p>#include <concepts></p>
<p>#endif</p>
<p>#else // defined(__cpp_concepts)</p>
<p>#error &ldquo;No support for concepts!&rdquo;</p>
<p>#endif</p>
<p>#define TEST_CONCEPT(Concept,      \<br>
Type)         \<br>
cout &laquo; #Concept &laquo; &lsquo;&lt;&rsquo; &laquo; #Type \<br>
&laquo; &ldquo;&gt;: &quot;                    \<br>
&laquo; Concept<Type> &laquo; endl</p>
<p>#define TEST_CONCEPT2(             \<br>
Concept, Type1, Type2)           \<br>
cout &laquo; #Concept &laquo; &lsquo;&lt;&rsquo;          \<br>
&laquo; #Type1 &laquo; &ldquo;, &quot; &laquo; #Type2 \<br>
&laquo; &ldquo;&gt;: &quot;                    \<br>
&laquo; Concept&lt;Type1,           \<br>
Type2&gt; &laquo; endl</p>
<p>int main()<br>
{<br>
cout &laquo; boolalpha;<br>
cout &laquo; &ldquo;__cpp_concepts is &quot;<br>
&laquo; __cpp_concepts &laquo; endl;<br>
TEST_CONCEPT(regular, int);<br>
TEST_CONCEPT(regular, char);<br>
TEST_CONCEPT(integral, int);<br>
TEST_CONCEPT(integral, char);<br>
TEST_CONCEPT(readable, int);<br>
TEST_CONCEPT(readable,<br>
unique_ptr<int>);<br>
TEST_CONCEPT2(<br>
writable, unique_ptr<int>, int);<br>
TEST_CONCEPT2(writable,<br>
unique_ptr<int>,<br>
double);<br>
TEST_CONCEPT2(writable,<br>
unique_ptr<int>,<br>
int*);<br>
TEST_CONCEPT(semiregular,<br>
unique_ptr<int>);<br>
TEST_CONCEPT(semiregular,<br>
shared_ptr<int>);<br>
TEST_CONCEPT(equality_comparable,<br>
unique_ptr<int>);<br>
TEST_CONCEPT(semiregular,<br>
arma::imat);<br>
TEST_CONCEPT2(assignable_from,<br>
arma::imat&amp;,<br>
arma::imat&amp;);<br>
TEST_CONCEPT(semiregular,<br>
arma::imat22);<br>
TEST_CONCEPT2(assignable_from,<br>
arma::imat22&amp;,<br>
arma::imat22&amp;);<br>
}</p>
<p>ä»£ç ç…§é¡¾äº†ä¸¤ç§å¯èƒ½çš„ç¯å¢ƒï¼š</p>
<ol>
<li>æœ€æ–°çš„ MSVCï¼ˆéœ€è¦ä½¿ç”¨ <code>/std:c++latest</code>ï¼›æˆ‘ç”¨çš„æ˜¯ Visual Studio 2019 16.4.4ï¼‰</li>
<li>GCCï¼ˆéœ€è¦ä½¿ç”¨ <code>-fconcepts</code>ï¼›æˆ‘æµ‹è¯•äº† 7ã€8ã€9 ä¸‰ä¸ªç‰ˆæœ¬éƒ½å¯ä»¥ï¼‰å’Œ CMCSTL2ï¼ˆéœ€è¦å°†å…¶ include ç›®å½•ç”¨ <code>-I</code> é€‰é¡¹åŠ åˆ°å‘½ä»¤è¡Œä¸Šï¼‰</li>
</ol>
<p>ç¨‹åºåœ¨ MSVC ä¸‹çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<blockquote>
<p><code>__cpp_concepts is 201811</code></p>
<p><code>regular&lt;int&gt;: true</code></p>
<p><code>regular&lt;char&gt;: true</code></p>
<p><code>integral&lt;int&gt;: true</code></p>
<p><code>integral&lt;char&gt;: true</code></p>
<p><code>readable&lt;int&gt;: false</code></p>
<p><code>readable&lt;unique_ptr&lt;int&gt;&gt;: true</code></p>
<p><code>writable&lt;unique_ptr&lt;int&gt;, int&gt;: true</code></p>
<p><code>writable&lt;unique_ptr&lt;int&gt;, double&gt;: true</code></p>
<p><code>writable&lt;unique_ptr&lt;int&gt;, int*&gt;: false</code></p>
<p><code>semiregular&lt;unique_ptr&lt;int&gt;&gt;: false</code></p>
<p><code>semiregular&lt;shared_ptr&lt;int&gt;&gt;: true</code></p>
<p><code>equality_comparable&lt;unique_ptr&lt;int&gt;&gt;: true</code></p>
<p><code>semiregular&lt;arma::imat&gt;: true</code></p>
<p><code>assignable_from&lt;arma::imat&amp;, arma::imat&amp;&gt;: true</code></p>
<p><code>semiregular&lt;arma::imat22&gt;: false</code></p>
<p><code>assignable_from&lt;arma::imat22&amp;, arma::imat22&amp;&gt;: false</code></p>
</blockquote>
<p>é™¤äº†ç¬¬ä¸€è¡Œ <code>__cpp_concepts</code> çš„è¾“å‡ºï¼ŒGCC çš„ç»“æœä¹Ÿæ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚å¤§éƒ¨åˆ†çš„ç»“æœåº”å½“æ²¡æœ‰æ„å¤–ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„ï¼ŒæŸäº›ç”¨èµ·æ¥æ²¡é—®é¢˜çš„ç±»ï¼ˆå¦‚ <code>arma::imat22</code>ï¼‰ï¼Œå´å› ä¸ºä¸€äº›å®ç°ä¸Šçš„ç‰¹æ®ŠæŠ€æœ¯ï¼Œä¸èƒ½æ»¡è¶³ <code>semiregular</code>ã€‚â€”â€”æ¦‚å¿µè¦æ¯”é¸­å­ç±»å‹æ›´ä¸ºä¸¥æ ¼ã€‚</p>
<h2 id="æ¦‚å¿µå‡ºé”™ä¿¡æ¯å’Œ-sfinae">æ¦‚å¿µã€å‡ºé”™ä¿¡æ¯å’Œ SFINAE</h2>
<p>æ˜¾ç„¶ï¼Œå¯¹äºä¸Šé¢å‡ºç°çš„è¿™ä¸ªä¾‹å­ï¼š</p>
<p>template <Integer N><br>
N half(N n)<br>
{<br>
return n / 2;<br>
}</p>
<p>æˆ‘ä»¬ç”¨ <code>enable_if</code> ä¹Ÿæ˜¯èƒ½å†™å‡ºæ¥çš„ï¼š</p>
<p>template <typename N><br>
enable_if_t&lt;Integer<N>, N&gt;<br>
half(N n)<br>
{<br>
return n / 2;<br>
}</p>
<p>ä¸è¿‡ï¼Œä½ ä¸ä¼šè§‰å¾—è¿™ç§æ–¹å¼æ›´å¥½å§ï¼Ÿè€Œä¸”ï¼Œå¯¹äºæ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µï¼Œè¦ç”¨å¯¹ <code>enable_if</code> è¿˜æ˜¯éå¸¸éº»çƒ¦çš„ï¼ˆå‚è§ [8] é‡Œçš„ Notes / æ³¨è§£éƒ¨åˆ†ï¼‰ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œâ€œæ¦‚å¿µâ€å¯ä»¥æä¾›æ›´ä¸ºå‹å¥½å¯è¯»çš„ä»£ç ï¼Œä»¥åŠæ½œåœ¨æ›´ä¸ºå‹å¥½çš„å‡ºé”™ä¿¡æ¯ã€‚æ‹¿ Andrew Sutton çš„ä¸€ä¸ªä¾‹å­ [9]ï¼ˆæ ¹æ®æˆ‘ä»¬ä¸ŠèŠ‚è¯´çš„ç¼–è¯‘ç¯å¢ƒåšäº†æ”¹ç¼–ï¼‰ï¼š</p>
<p>#include <string><br>
#include <vector></p>
<p>using namespace std;</p>
<p>#if defined(__cpp_concepts)</p>
<p>#if __cpp_concepts &lt; 201811</p>
<p>#include &lt;experimental/ranges/concepts&gt;<br>
using namespace experimental::ranges;</p>
<p>#else</p>
<p>#include <concepts><br>
using namespace ranges;</p>
<p>#endif</p>
<p>#define REQUIRES(x) requires x</p>
<p>#else // defined(__cpp_concepts)</p>
<p>#define REQUIRES(x)</p>
<p>#endif</p>
<p>template &lt;typename R, typename T&gt;<br>
REQUIRES(<br>
(range<R> &amp;&amp;<br>
equality_comparable_with&lt;<br>
T, typename R::value_type&gt;))<br>
bool in(R const&amp; r, T const&amp; value)<br>
{<br>
for (auto const&amp; x : r)<br>
if (x == value)<br>
return true;<br>
return false;<br>
}</p>
<p>int main()<br>
{<br>
vector<string> v{&ldquo;Hello&rdquo;,<br>
&ldquo;World&rdquo;};<br>
in(v, &ldquo;Hello&rdquo;);<br>
in(v, 0);<br>
}</p>
<p>ä»¥ GCC 8 ä¸ºä¾‹ï¼Œå¦‚æœä¸ä½¿ç”¨æ¦‚å¿µçº¦æŸï¼Œ<code>in(v, 0)</code> è¿™è¡Œä¼šäº§ç”Ÿ 166 è¡Œå‡ºé”™ä¿¡æ¯ï¼›è€Œå¯ç”¨äº†æ¦‚å¿µçº¦æŸåï¼Œå‡ºé”™ä¿¡æ¯ç¼©å‡åˆ°äº† 8 è¡Œã€‚MSVC ä¸Šå¯¹äºè¿™ä¸ªä¾‹å­ä¸ä½¿ç”¨æ¦‚å¿µé”™è¯¯ä¿¡æ¯ä¹Ÿè¾ƒçŸ­ï¼Œä½†å¯ç”¨äº†æ¦‚å¿µåä»ç„¶èƒ½äº§ç”Ÿæ›´çŸ­ã€æ›´æ˜ç¡®çš„å‡ºé”™ä¿¡æ¯ï¼š</p>
<blockquote>
<p><code>test.cpp(46): error C2672: 'in': no matching overloaded function found</code></p>
<p><code>test.cpp(46): error C7602: 'in': the associated constraints are not satisfied</code></p>
<p><code>test.cpp(33): note: see declaration of 'in'</code></p>
</blockquote>
<p>éšç€ç¼–è¯‘å™¨çš„æ”¹è¿›ï¼Œæ¦‚å¿µåœ¨å‡ºé”™ä¿¡æ¯ä¸Šçš„ä¼˜åŠ¿åœ¨æ¶ˆå‡ï¼Œä½†åœ¨ä»£ç è¡¨è¾¾ä¸Šçš„ä¼˜åŠ¿ä»ç„¶æ˜¯å®å®åœ¨åœ¨çš„ã€‚è®°å¾— [ç¬¬ 14 è®²] é‡Œæˆ‘ä»¬è´¹äº†å¥½å¤§çš„åŠ²ã€ç”¨äº†å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥å®šä¹‰ <code>has_reserve</code> å—ï¼Ÿåœ¨æ¦‚å¿µé¢å‰ï¼Œé‚£äº›å°±æˆäº†â€œå›â€å­—æœ‰å‡ ç§å†™æ³•äº†ã€‚æˆ‘ä»¬å¯ä»¥é£å¿«åœ°å®šä¹‰ä¸‹é¢çš„æ¦‚å¿µï¼š</p>
<p>template <typename T><br>
concept has_reserve =<br>
requires(T&amp; dest) {<br>
dest.reserve(1U);<br>
};</p>
<p>è¿™ä¸ªæ¦‚å¿µç”¨åœ¨ç¼–è¯‘æœŸæ¡ä»¶è¯­å¥é‡Œï¼Œæ•ˆæœå’Œä¹‹å‰çš„å®Œå…¨ç›¸åŒâ€¦â€¦å“¦ï¼Œé”™äº†ï¼Œä¸ç”¨å†å†™ <code>::value</code> æˆ– <code>{}</code> äº†ğŸ˜‚ã€‚</p>
<p>åœ¨ [ç¬¬ 13 è®²] æˆ‘ç»™å‡ºè¿‡çš„ <code>fmap</code>ï¼Œåœ¨å®é™…ä»£ç ä¸­æˆ‘ä¹Ÿæ˜¯ç”¨äº† SFINAE æ¥è¿›è¡Œçº¦æŸçš„ï¼ˆç•¥ç®€åŒ–ï¼‰ï¼š</p>
<p>template &lt;<br>
template &lt;typename, typename&gt;<br>
class OutContainer = vector,<br>
typename F, class R&gt;<br>
auto fmap(F&amp;&amp; f, R&amp;&amp; inputs)<br>
-&gt; decltype(<br>
begin(inputs),<br>
end(inputs),<br>
OutContainer&lt;decay_t&lt;<br>
decltype(f(*begin(<br>
inputs)))&raquo;());</p>
<p>æˆ‘è´¹äº†è€å¤§çš„åŠ²ï¼Œè¦æŠŠè¿”å›å€¼å†™å‡ºæ¥ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸ºäº†åˆ©ç”¨ SFINAE è€Œå·²ã€‚å¦‚æœä½¿ç”¨â€œæ¦‚å¿µâ€ï¼Œé‚£ä»£ç å¯ä»¥ç®€åŒ–æˆï¼š</p>
<p>template &lt;<br>
template &lt;typename, typename&gt;<br>
class OutContainer = vector,<br>
typename F, class R&gt;<br>
requires requires(R&amp;&amp; r) {<br>
begin(r);<br>
end(r);<br>
}<br>
auto fmap(F&amp;&amp; f, R&amp;&amp; inputs);</p>
<p>ä¸Šé¢çš„ <code>requires requires</code> ä¸æ˜¯é”™è¯¯ï¼Œæ­£å¦‚ <code>noexcept(noexcept(â€¦))</code> ä¸æ˜¯é”™è¯¯ä¸€æ ·ã€‚ç¬¬ä¸€ä¸ª <code>requires</code> å¼€å§‹ä¸€ä¸ª <strong>requires å­å¥</strong>ï¼Œåé¢è·Ÿä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œç»“æœçš„çœŸå‡è¡¨ç¤ºæ˜¯å¦æ»¡è¶³äº†æ¨¡æ¿çš„çº¦æŸæ¡ä»¶ã€‚ç¬¬äºŒä¸ª <code>requires</code> åˆ™å¼€å§‹äº†ä¸€ä¸ª <strong>requires è¡¨è¾¾å¼</strong>ï¼šå¦‚æœç±»å‹ <code>R</code> æ»¡è¶³çº¦æŸâ€”â€”å¯ä»¥ä½¿ç”¨ <code>begin</code> å’Œ <code>end</code> å¯¹ <code>R&amp;&amp;</code> ç±»å‹çš„å˜é‡è¿›è¡Œè°ƒç”¨â€”â€”åˆ™è¿”å›çœŸï¼Œå¦åˆ™è¿”å›å‡ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨ C++20 é‡Œï¼Œä¸Šé¢è¿™ä¸ªæ¡ä»¶æˆ‘æ˜¯ä¸éœ€è¦è¿™ä¹ˆå†™å‡ºæ¥çš„ã€‚æœ‰ä¸€ä¸ªç°æˆçš„æ¦‚å¿µå¯ç”¨ï¼Œè¿™ä¹ˆå†™å°±è¡Œäº†ï¼š</p>
<p>template &lt;<br>
template &lt;typename, typename&gt;<br>
class OutContainer = vector,<br>
typename F, class R&gt;<br>
requires range<R><br>
auto fmap(F&amp;&amp; f, R&amp;&amp; inputs);</p>
<p>å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»Šå¤©ç¬¬äºŒæ¬¡ç”¨äº† <code>range</code> è¿™ä¸ªæ¦‚å¿µã€‚ç©¶ç«Ÿä»€ä¹ˆæ˜¯ rangeï¼Ÿæˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€è®²å†è¯´ã€‚</p>
<h2 id="å†…å®¹å°ç»“">å†…å®¹å°ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬è®¨è®ºäº† C++20 é‡Œå¯ä»¥è¯´æ˜¯æœ€é‡è¦çš„æ–°åŠŸèƒ½â€”â€”æ¦‚å¿µã€‚æ¦‚å¿µå¯ä»¥ç”¨æ¥å¯¹æ¨¡æ¿å‚æ•°è¿›è¡Œçº¦æŸï¼Œèƒ½å–ä»£ SFINAEï¼Œäº§ç”Ÿæ›´å¥½ã€æ›´å¯è¯»çš„ä»£ç ã€‚</p>
<p>æ³¨æ„æœ¬è®²çš„å†…å®¹å¹¶éä¸€ä¸ªå½¢å¼åŒ–çš„æè¿°ï¼Œè¯·ä½ åœ¨é˜…è¯»äº†æœ¬è®²çš„å†…å®¹ä¹‹åï¼Œå†å¯¹ç…§å‚è€ƒèµ„æ–™ [6] çš„å†…å®¹çœ‹ä¸€ä¸‹æ›´ä¸¥æ ¼çš„æè¿°ï¼Œç„¶åå†å›è¿‡å¤´æ¥è¯»ä¸€ä¸‹ä¾‹å­ï¼Œæ¥åŠ æ·±ä½ å¯¹æœ¬è®²å†…å®¹çš„ç†è§£ã€‚</p>
<h2 id="è¯¾åæ€è€ƒ">è¯¾åæ€è€ƒ</h2>
<p>è¯·ç»“åˆè‡ªå·±çš„ C++ é¡¹ç›®ï¼Œè€ƒè™‘ä¸€ä¸‹ï¼Œâ€œæ¦‚å¿µâ€å¯ä»¥ä¸ºå¼€å‘å…·ä½“å¸¦æ¥å“ªäº›å¥½å¤„ï¼Ÿåè¿‡æ¥ï¼Œè´Ÿé¢çš„å½±å“åˆå¯èƒ½ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<p>[1] Bjarne Stroustrup, â€œConcepts: the future of generic programming, or how to design good concepts and use them wellâ€. <a href="http://www.stroustrup.com/good">http://www.stroustrup.com/good</a>_concepts.pdf</p>
<p>[2] Alexander Stepanov and Paul McJones, Elements of Programming. Addison-Wesley, 2009. æœ‰ä¸­æ–‡ç‰ˆï¼ˆè£˜å®—ç‡•è¯‘ã€Šç¼–ç¨‹åŸæœ¬ã€‹ï¼Œäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2019 å¹´ï¼‰</p>
<p>[3] ISO/IEC JTC1 SC22 WG21, N4549, â€œProgramming languages â€” C++ extensions for conceptsâ€. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4549.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4549.pdf</a></p>
<p>[4] Herb Sutter et al., â€œRename concepts to standard_case for C++20, while we still canâ€. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1754r1.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1754r1.pdf</a></p>
<p>[5] cppreference.com, â€œStandard library header <concepts>â€. <a href="https://en.cppreference.com/w/cpp/header/concepts">https://en.cppreference.com/w/cpp/header/concepts</a>.</p>
<p>[5a] cppreference.com, â€œæ ‡å‡†åº“å¤´æ–‡ä»¶ <concepts>â€. <a href="https://zh.cppreference.com/w/cpp/header/concepts">https://zh.cppreference.com/w/cpp/header/concepts</a>.</p>
<p>[6] Casey Carter et al., cmcstl2. <a href="https://github.com/CaseyCarter/cmcstl2">https://github.com/CaseyCarter/cmcstl2</a></p>
<p>[7] cppreference.com, â€œConstraints and conceptsâ€. <a href="https://en.cppreference.com/w/cpp/language/constraints">https://en.cppreference.com/w/cpp/language/constraints</a></p>
<p>[7a] cppreference.com, â€œçº¦æŸä¸æ¦‚å¿µâ€. <a href="https://zh.cppreference.com/w/cpp/language/constraints">https://zh.cppreference.com/w/cpp/language/constraints</a></p>
<p>[8] cppreference.com, â€œstd::enable_ifâ€. <a href="https://en.cppreference.com/w/cpp/types/enable">https://en.cppreference.com/w/cpp/types/enable</a>_if</p>
<p>[8a] cppreference.com, â€œstd::enable_ifâ€. <a href="https://zh.cppreference.com/w/cpp/types/enable">https://zh.cppreference.com/w/cpp/types/enable</a>_if</p>
<p>[9] Andrew Sutton, â€œIntroducing conceptsâ€. <a href="https://accu.org/index.php/journals/2157">https://accu.org/index.php/journals/2157</a></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%8E%B0%E4%BB%A3c&#43;&#43;%E5%AE%9E%E6%88%9830%E8%AE%B2/">ç°ä»£C&#43;&#43;å®æˆ˜30è®²</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E8%B7%9F%E6%9C%88%E5%BD%B1%E5%AD%A6%E5%8F%AF%E8%A7%86%E5%8C%96/28__canvassvg%E4%B8%8Ewebgl%E5%9C%A8%E6%80%A7%E8%83%BD%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8A%BF%E4%B8%8E%E5%8A%A3%E5%8A%BF/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">28__Canvasã€SVGä¸WebGLåœ¨æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ä¸åŠ£åŠ¿</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/28__i_o%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E8%BF%9B%E9%98%B6%E5%AD%90%E7%BA%BF%E7%A8%8B%E4%BD%BF%E7%94%A8poll%E5%A4%84%E7%90%86%E8%BF%9E%E6%8E%A5i_o%E4%BA%8B%E4%BB%B6/">
            <span class="next-text nav-default">28__I_Oå¤šè·¯å¤ç”¨è¿›é˜¶ï¼šå­çº¿ç¨‹ä½¿ç”¨pollå¤„ç†è¿æ¥I_Oäº‹ä»¶</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
